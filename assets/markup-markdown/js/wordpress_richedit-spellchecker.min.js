/**
 * @preserve Markup Markdown Spell Check wizard
 * @version 1.0.0 
 * @license GPL 3 - https://www.gnu.org/licenses/gpl-3.0.html#license-text
 */
((e,s)=>{function t(e){if(!e)return!1;this.cm=e,this.el=null,this.display=!1,this.active=!1,this.from={},this.to={},this.origin={},this.lang="",this.initialize()}t.prototype.hideSuggestPanel=function(e){var t=this;return!(!t.el||(t.el.style.display="none",t.el.innerHTML=""))},t.prototype.showSuggestPanel=function(e){var t=this;return!!t.el&&(t.el.style.top=Math.ceil(e.clientY||0)+16+"px",t.el.style.left=Math.ceil(e.clientX||0)-16+"px",t.el.style.display="block",!0)},t.prototype.buildSuggestPanel=function(){var t=this;return!(t.el&&t.el.id||(t.el=s.createElement("div"),t.el.id="mmd-suggestions",t.el.className="mmd-spellcheck-suggestions",s.body.appendChild(t.el),s.getElementById("mmd-suggestions").addEventListener("click",function(e){return event.preventDefault(),t.cm.replaceRange(e.target.firstChild.nodeValue,t.from,t.to,t.origin),setTimeout(function(){t.hideSuggestPanel(e)},450),!1},!1),0))},t.prototype.checkSelectedWord=function(e){var t=this;e&&e.target&&/cm-spell-error/.test(e.target.className||"")?(t.display||(t.buildSuggestPanel(),t.display=!0),t.showSuggestPanel(e),t.lang=(e.target.className||"").match(/.*?cm-(\w+)$/)[1],t.active=!0):t.active&&(t.active=!1,t.hideSuggestPanel(e))},t.prototype.updateSuggestions=function(e){var t=this;if(!t.active)return!1;var i=e.getCursor(),i=e.findWordAt(i);if(i&&i.anchor&&i.head&&CodeMirrorSpellChecker.typo(t.lang)){for(var e=e.getRange(i.anchor,i.head),n=CodeMirrorSpellChecker.typo(t.lang,"suggest",e),l=["<ol>"],o=0;o<n.length;o++)/\d+/.test(n[o])||l.push('<li><a href="#mmd-suggestions">'+n[o]+"</li>");l.push("</ol>"),t.el=s.getElementById("mmd-suggestions"),t.el.innerHTML=l.join(""),t.from=i.anchor,t.to=i.head,t.origin=e}return t.active=!0},t.prototype.initialize=function(){var i=this;i.cm.on("mousedown",function(e,t){i.checkSelectedWord(t)}),i.cm.on("cursorActivity",function(e){i.updateSuggestions(e)})},e.MmdSpellWizard=t})(window,document);