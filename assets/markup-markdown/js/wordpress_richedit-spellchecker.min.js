/**
 * @preserve The Markup Markdown's Spell Check Wizard Module
 * @desc Word suggestions from hungspell dictionaries
 * @author Pierre-Henri Lavigne <lavigne.pierrehenri@protonmail.com>
 * @version 1.0.0 
 * @license GPL 3 - https://www.gnu.org/licenses/gpl-3.0.html#license-text
 */
((e,r)=>{var n,a;function t(e){if(!e)return!1;this.cm=e,this.display=!1,this.active=!1,this.from={},this.to={},this.origin={},this.lang="",this.initialize()}t.prototype.hideSuggestPanel=function(e){return!(!a||(a.style.display="none",a.innerHTML=""))},t.prototype.showSuggestPanel=function(e){return!!a&&(a.style.top=Math.ceil(e.clientY||0)+16+"px",a.style.left=Math.ceil(e.clientX||0)-16+"px",a.style.display="block",!0)},t.prototype.buildSuggestPanel=function(){var t=this;return!(a&&a.id||((a=r.createElement("div")).id="mmd-suggestions",a.className="mmd-spellcheck-suggestions",r.body.appendChild(a),r.getElementById("mmd-suggestions").addEventListener("click",function(e){return e.preventDefault(),n&&(n.replaceRange(e.target.firstChild.nodeValue,t.from,t.to,t.origin),setTimeout(function(){t.hideSuggestPanel(e)},450)),!1},!1),0))},t.prototype.checkSelectedWord=function(e){var t=this;e&&e.target&&/cm-spell-error/.test(e.target.className||"")?(t.display||(t.buildSuggestPanel(),t.display=!0),t.showSuggestPanel(e),t.lang=(e.target.className||"").match(/.*?cm-(\w+)$/)[1],t.active=!0):t.active&&(t.active=!1,t.hideSuggestPanel(e))},t.prototype.updateSuggestions=function(e){var t=this;if(!t.active)return!1;t.active=!0;var i=e.getCursor(),i=e.findWordAt(i);if(i&&i.anchor&&i.head&&CodeMirrorSpellChecker.typo(t.lang)){for(var e=e.getRange(i.anchor,i.head),n=CodeMirrorSpellChecker.typo(t.lang,"suggest",e),o=["<ol>"],s=0;s<n.length;s++)/\d+/.test(n[s])||o.push('<li><a href="#mmd-suggestions">'+n[s]+"</li>");o.push("</ol>"),(a=r.getElementById("mmd-suggestions")).innerHTML=o.join(""),t.from=i.anchor,t.to=i.head,t.origin=e}return!0},t.prototype.initialize=function(){var i=this;i.cm.on("mousedown",function(e,t){n=i.cm,i.checkSelectedWord(t)}),i.cm.on("cursorActivity",function(e){i.updateSuggestions(e)})},e.MmdSpellWizard=t})(window,document);